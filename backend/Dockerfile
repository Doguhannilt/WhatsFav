FROM node:18

WORKDIR /app


COPY backend/package*.json ./
RUN npm install
COPY backend/ ./


ARG MONGO_URI
ARG JWT_SECRET
ARG NODE_ENV
ARG SERVICE_ID
ARG TEMPLATE_ID
ARG PUBLIC_KEY
ARG IMAGE_URL

ENV MONGO_URI=$MONGO_URI
ENV JWT_SECRET=$JWT_SECRET
ENV NODE_ENV=$NODE_ENV
ENV SERVICE_ID=$SERVICE_ID
ENV TEMPLATE_ID=$TEMPLATE_ID
ENV PUBLIC_KEY=$PUBLIC_KEY
ENV IMAGE_URL=$IMAGE_URL

EXPOSE 5000
CMD ["npm", "start"]
